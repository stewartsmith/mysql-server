USE test;
DROP DATABASE IF EXISTS mysql_db1;
#
# Bug#40944 - Backup: crash after myisampack
#
CREATE DATABASE mysql_db1;
CREATE TABLE mysql_db1.t1 (c1 VARCHAR(5), c2 int);
CREATE INDEX i1 ON mysql_db1.t1 (c1, c2);
INSERT INTO mysql_db1.t1 VALUES ('A',1);
INSERT INTO mysql_db1.t1 SELECT * FROM mysql_db1.t1;
INSERT INTO mysql_db1.t1 SELECT * FROM mysql_db1.t1;
INSERT INTO mysql_db1.t1 SELECT * FROM mysql_db1.t1;
INSERT INTO mysql_db1.t1 SELECT * FROM mysql_db1.t1;
INSERT INTO mysql_db1.t1 SELECT * FROM mysql_db1.t1;
INSERT INTO mysql_db1.t1 SELECT * FROM mysql_db1.t1;
INSERT INTO mysql_db1.t1 SELECT * FROM mysql_db1.t1;
FLUSH TABLE mysql_db1.t1;
BACKUP DATABASE mysql_db1 to 'bup_myisam.bak';
backup_id
#
RESTORE FROM 'bup_myisam.bak' OVERWRITE;
backup_id
#
SELECT COUNT(*) FROM mysql_db1.t1 WHERE c2 < 5;
COUNT(*)
128
DROP TABLE mysql_db1.t1;
DROP DATABASE mysql_db1;

#
# Bug#38045 - Backup, MyISAM and file system encoding
#
CREATE DATABASE mysqltest;
USE mysqltest;
CREATE TABLE `äöüß£å` (id SERIAL);
BACKUP DATABASE mysqltest TO 'bup_myisam.bak';
backup_id
#
DROP TABLE `äöüß£å`;
USE test;
DROP DATABASE mysqltest;
