-- source include/have_ndb.inc

set storage_engine=ndb;
CREATE LOGFILE GROUP lg1
ADD UNDOFILE 'undofile.dat'
INITIAL_SIZE 4M
UNDO_BUFFER_SIZE = 1M;

set storage_engine=myisam;
CREATE TABLESPACE ts1
ADD DATAFILE 'datafile.dat'
USE LOGFILE GROUP lg1
INITIAL_SIZE 4M
ENGINE NDB;

CREATE TABLE t1
(pk1 INT NOT NULL PRIMARY KEY, b INT NOT NULL, c INT NOT NULL)
TABLESPACE ts1 STORAGE DISK
ENGINE=NDB;

SHOW CREATE TABLE t1;

INSERT INTO t1 VALUES (0, 0, 0);
SELECT * FROM t1;

INSERT INTO t1 VALUES 
(1,1,1),(2,2,2),(3,3,3),(4,4,4),(5,5,5);

SELECT COUNT(*) FROM t1;

SELECT * FROM INFORMATION_SCHEMA.TABLESPACES;

drop table t1;

CREATE TABLESPACE ts2
ADD DATAFILE 'ts2_datafile.dat'
USE LOGFILE GROUP lg1
INITIAL_SIZE 4M
ENGINE NDB;

SELECT * FROM INFORMATION_SCHEMA.TABLESPACES;

ALTER TABLESPACE ts1 
DROP DATAFILE 'datafile.dat' 
ENGINE = NDB;

SELECT * FROM INFORMATION_SCHEMA.TABLESPACES;

ALTER TABLESPACE ts2
DROP DATAFILE 'ts2_datafile.dat' 
ENGINE = NDB;

SELECT * FROM INFORMATION_SCHEMA.TABLESPACES;

DROP TABLESPACE ts1 
ENGINE = NDB;

SELECT * FROM INFORMATION_SCHEMA.TABLESPACES;

DROP TABLESPACE ts2
ENGINE = NDB;

SELECT * FROM INFORMATION_SCHEMA.TABLESPACES;

DROP LOGFILE GROUP lg1 
ENGINE =NDB;
