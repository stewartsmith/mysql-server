CREATE TABLESPACE ts1 ADD DATAFILE 'ts1.fts' ENGINE=Falcon;
CREATE TABLESPACE ts2 ADD DATAFILE 'ts2.fts' ENGINE=Falcon;
CREATE TABLESPACE ts3 ADD DATAFILE 'ts3.fts' ENGINE=Falcon;
CREATE TABLE t1 (a INT) ENGINE=Falcon TABLESPACE ts1
PARTITION BY RANGE(a) SUBPARTITION BY HASH(a) (
PARTITION p1 VALUES LESS THAN (100) TABLESPACE ts2 (
SUBPARTITION p1s1 TABLESPACE ts3,
SUBPARTITION p1s2
),
PARTITION p2 VALUES LESS THAN MAXVALUE (
SUBPARTITION p2s1,
SUBPARTITION p2s2
)
);
SELECT * FROM INFORMATION_SCHEMA.FALCON_TABLES WHERE
TABLE_NAME = 't1' AND SCHEMA_NAME='test';
SCHEMA_NAME	TABLE_NAME	PARTITION	TABLESPACE	INTERNAL_NAME
TEST	T1	P1S1	ts3	T1#P#P1#SP#P1S1
TEST	T1	P1S2	ts2	T1#P#P1#SP#P1S2
TEST	T1	P2S1	ts1	T1#P#P2#SP#P2S1
TEST	T1	P2S2	ts1	T1#P#P2#SP#P2S2
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) DEFAULT NULL
) /*!50100 TABLESPACE `ts1` */ ENGINE=Falcon DEFAULT CHARSET=latin1 /*!50100 PARTITION BY RANGE (a) SUBPARTITION BY HASH (a) (PARTITION p1 VALUES LESS THAN (100) (SUBPARTITION p1s1 TABLESPACE = ts3 ENGINE = Falcon, SUBPARTITION p1s2 TABLESPACE = ts2 ENGINE = Falcon), PARTITION p2 VALUES LESS THAN MAXVALUE (SUBPARTITION p2s1 TABLESPACE = ts1 ENGINE = Falcon, SUBPARTITION p2s2 TABLESPACE = ts1 ENGINE = Falcon)) */
ALTER TABLE t1 REMOVE PARTITIONING;
SELECT * FROM INFORMATION_SCHEMA.FALCON_TABLES WHERE
TABLE_NAME = 't1' AND SCHEMA_NAME='test';
SCHEMA_NAME	TABLE_NAME	PARTITION	TABLESPACE	INTERNAL_NAME
TEST	T1		ts1	T1
ALTER TABLE t1 TABLESPACE ts1
PARTITION BY RANGE(a) SUBPARTITION BY HASH(a) (
PARTITION p1 VALUES LESS THAN (100) TABLESPACE ts2 (
SUBPARTITION p1s1 TABLESPACE ts3,
SUBPARTITION p1s2
),
PARTITION p2 VALUES LESS THAN (200) (
SUBPARTITION p2s1,
SUBPARTITION p2s2
)
);
SELECT * FROM INFORMATION_SCHEMA.FALCON_TABLES WHERE
TABLE_NAME = 't1' AND SCHEMA_NAME='test';
SCHEMA_NAME	TABLE_NAME	PARTITION	TABLESPACE	INTERNAL_NAME
TEST	T1	P1S1	ts3	T1#P#P1#SP#P1S1
TEST	T1	P1S2	ts2	T1#P#P1#SP#P1S2
TEST	T1	P2S1	ts1	T1#P#P2#SP#P2S1
TEST	T1	P2S2	ts1	T1#P#P2#SP#P2S2
ALTER TABLE t1 ADD PARTITION (PARTITION p3 VALUES LESS THAN MAXVALUE);
SELECT * FROM INFORMATION_SCHEMA.FALCON_TABLES WHERE
TABLE_NAME = 't1' AND SCHEMA_NAME='test';
SCHEMA_NAME	TABLE_NAME	PARTITION	TABLESPACE	INTERNAL_NAME
TEST	T1	P1S1	ts3	T1#P#P1#SP#P1S1
TEST	T1	P1S2	ts2	T1#P#P1#SP#P1S2
TEST	T1	P2S1	ts1	T1#P#P2#SP#P2S1
TEST	T1	P2S2	ts1	T1#P#P2#SP#P2S2
TEST	T1	P3SP0	ts1	T1#P#P3#SP#P3SP0
TEST	T1	P3SP1	ts1	T1#P#P3#SP#P3SP1
ALTER TABLE t1 REORGANIZE PARTITION p3 INTO (PARTITION p3 VALUES LESS THAN
MAXVALUE TABLESPACE ts1);
SELECT * FROM INFORMATION_SCHEMA.FALCON_TABLES WHERE
TABLE_NAME = 't1' AND SCHEMA_NAME='test';
SCHEMA_NAME	TABLE_NAME	PARTITION	TABLESPACE	INTERNAL_NAME
TEST	T1	P1S1	ts3	T1#P#P1#SP#P1S1
TEST	T1	P1S2	ts2	T1#P#P1#SP#P1S2
TEST	T1	P2S1	ts1	T1#P#P2#SP#P2S1
TEST	T1	P2S2	ts1	T1#P#P2#SP#P2S2
TEST	T1	P3SP0	ts1	T1#P#P3#SP#P3SP0
TEST	T1	P3SP1	ts1	T1#P#P3#SP#P3SP1
ALTER TABLE t1 REORGANIZE PARTITION p3 INTO (PARTITION p3 VALUES LESS THAN
MAXVALUE TABLESPACE ts2);
SELECT * FROM INFORMATION_SCHEMA.FALCON_TABLES WHERE
TABLE_NAME = 't1' AND SCHEMA_NAME='test';
SCHEMA_NAME	TABLE_NAME	PARTITION	TABLESPACE	INTERNAL_NAME
TEST	T1	P1S1	ts3	T1#P#P1#SP#P1S1
TEST	T1	P1S2	ts2	T1#P#P1#SP#P1S2
TEST	T1	P2S1	ts1	T1#P#P2#SP#P2S1
TEST	T1	P2S2	ts1	T1#P#P2#SP#P2S2
TEST	T1	P3SP0	ts2	T1#P#P3#SP#P3SP0
TEST	T1	P3SP1	ts2	T1#P#P3#SP#P3SP1
ALTER TABLE t1 REORGANIZE PARTITION p1 INTO (PARTITION p1 VALUES LESS THAN
(100) TABLESPACE ts2);
SELECT * FROM INFORMATION_SCHEMA.FALCON_TABLES WHERE
TABLE_NAME = 't1' AND SCHEMA_NAME='test';
SCHEMA_NAME	TABLE_NAME	PARTITION	TABLESPACE	INTERNAL_NAME
TEST	T1	P2S1	ts1	T1#P#P2#SP#P2S1
TEST	T1	P2S2	ts1	T1#P#P2#SP#P2S2
TEST	T1	P3SP0	ts2	T1#P#P3#SP#P3SP0
TEST	T1	P3SP1	ts2	T1#P#P3#SP#P3SP1
TEST	T1	P1SP0	ts2	T1#P#P1#SP#P1SP0
TEST	T1	P1SP1	ts2	T1#P#P1#SP#P1SP1
DROP TABLE t1;
DROP TABLESPACE ts1 ENGINE=Falcon;
DROP TABLESPACE ts2 ENGINE=Falcon;
DROP TABLESPACE ts3 ENGINE=Falcon;
