*** Bug #35939 ***
SET @@storage_engine = 'Falcon';
DROP TABLE IF EXISTS t1;
CREATE TABLE t1(i int);
INSERT INTO t1(i) VALUES (1),(2),(3),(4);
SELECT TABLE_ROWS  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 't1';
TABLE_ROWS
4
UPDATE t1 set i=i+1;
SELECT TABLE_ROWS  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 't1';
TABLE_ROWS
4
DELETE FROM t1 WHERE i=2;
SELECT TABLE_ROWS  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 't1';
TABLE_ROWS
3
SET AUTOCOMMIT=OFF;
BEGIN;
INSERT INTO t1(i) VALUES(42);
DELETE FROM t1 WHERE i=42;
COMMIT;
SELECT TABLE_ROWS  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 't1';
TABLE_ROWS
3
BEGIN;
DELETE FROM t1 WHERE i=4;
INSERT INTO t1(i) VALUES(4);
COMMIT;
SELECT TABLE_ROWS  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 't1';
TABLE_ROWS
3
BEGIN;
INSERT INTO t1(i) VALUES(42);
UPDATE t1 SET i=43 WHERE i=42;
DELETE FROM t1 WHERE i=43;
COMMIT;
SELECT TABLE_ROWS  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 't1';
TABLE_ROWS
3
BEGIN;
DELETE FROM t1 WHERE i=4;
INSERT INTO t1(i) VALUES(4);
UPDATE t1 SET i=42 WHERE i=4;
UPDATE t1 SET i=4 WHERE i=42;
COMMIT;
SELECT TABLE_ROWS  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 't1';
TABLE_ROWS
3
BEGIN;
INSERT INTO t1(i) VALUES(42);
UPDATE t1 SET i=43 WHERE i=42;
DELETE FROM t1 WHERE i=43;
ROLLBACK;
SELECT TABLE_ROWS  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 't1';
TABLE_ROWS
3
SET AUTOCOMMIT=ON;
SELECT count(*) FROM t1;
count(*)
3
DROP TABLE t1;
